---
- name: Print Join command
  debug:
    msg: "Joind command: {{ kubernetes_join_command }}"

- name: Stop kubelet if it is running and using port 10250
  service:
    name: kubelet
    state: stopped

- name: Join node to Kubernetes control plane.
  shell: >
    {{ kubernetes_join_command }}
    creates=/etc/kubernetes/kubelet.conf
  tags: ['skip_ansible_lint']
  when: kubernetes_join_command is defined

- name: Stop kubelet if it is running and using port 10250
  service:
    name: kubelet
    state: started
